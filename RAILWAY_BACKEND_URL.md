# Railway Backend Deployment Guide

## How to Get Your Railway Backend URL

### Step 1: Check Deployment Status
1. Go to https://railway.app/dashboard
2. Click on your **WebWorlds** project
3. Click on the **Backend** service

### Step 2: Find Your URL in Railway Dashboard

**Location**: Look for **Networking** section or **Deployments** tab

You'll see something like:
```
Domain: webworlds-backend-xxx.railway.app
Port: xxxx (usually hidden, auto-managed)
```

The URL format is automatically generated by Railway:
```
https://webworlds-backend-<random-id>.railway.app
```

**You DON'T need to specify a port!** Railway automatically:
- Maps PORT environment variable to an internal port
- Your Procfile uses `npm start` which runs on PORT set by Railway
- Railway exposes it via HTTPS on the domain above

### Step 3: Copy the URL

- Your full backend URL is: **`https://webworlds-backend-xxx.railway.app`**
- For API calls, use: **`https://webworlds-backend-xxx.railway.app/api`**

---

## Environment Variables Set by Railway

Railway automatically provides these environment variables:

| Variable | Value | Example |
|----------|-------|---------|
| `PORT` | Auto-assigned port | `3000`, `3001`, etc |
| `NODE_ENV` | Set in Railway settings | `production` |

Your backend code reads `PORT` from `process.env.PORT` in `src/server.ts`

---

## Testing Your Backend URL

### Option 1: Direct API Test
```bash
curl https://webworlds-backend-xxx.railway.app/api/health
```
Should return status `200 OK`

### Option 2: Check Logs
In Railway dashboard:
1. Click **Backend** service
2. Click **Deployments** tab
3. View logs to see if server started successfully
4. Look for: `Server running on port XXX`

### Option 3: Test from Frontend
After deploying to Vercel, set environment variable:
```
NEXT_PUBLIC_API_URL=https://webworlds-backend-xxx.railway.app/api
```

---

## Common Issues & Solutions

### Issue: "Cannot reach backend"
- Check if Railway deployment is running (green status)
- Verify MONGODB_URI environment variable is set in Railway
- Check backend logs for errors
- Ensure JWT_SECRET is set

### Issue: "Port not specified"
- Railway auto-assigns port
- Don't add port to URL (e.g., ❌ `webworlds-backend-xxx:3000`)
- Use just domain (e.g., ✅ `webworlds-backend-xxx.railway.app`)

### Issue: "CORS errors"
- Backend has CORS enabled in `src/app.ts`
- Make sure frontend URL is not in CORS blocklist
- Check browser console for actual error message

---

## Your Backend Service Details

**Service Name**: Backend  
**Repo Path**: `/backend`  
**Start Command**: `npm run build && npm start`  
**Build Command**: `tsc` (TypeScript compile)  
**Main File**: `src/server.ts`  
**API Port**: Auto-assigned (read from `process.env.PORT`)  

---

## Next Step: Use URL in Vercel

Once you have your Railway URL, add it to Vercel:

1. Go to Vercel project settings
2. Environment Variables section
3. Add: `NEXT_PUBLIC_API_URL = https://webworlds-backend-xxx.railway.app/api`
4. Redeploy frontend

Done! Frontend will now connect to your Railway backend.
